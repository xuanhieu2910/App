"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.fetchSessionSecretAndSsoUserAsync = void 0;
const api_1 = require("../api");
const expoSsoLauncher_1 = require("./expoSsoLauncher");
const fetchUser_1 = require("./fetchUser");
async function fetchSessionSecretAndSsoUserAsync() {
    const config = {
        expoWebsiteUrl: (0, api_1.getExpoWebsiteBaseUrl)(),
        serverPort: await (0, api_1.getSsoLocalServerPortAsync)(),
    };
    const sessionSecret = await (0, expoSsoLauncher_1.getSessionUsingBrowserAuthFlowAsync)(config);
    const userData = await (0, fetchUser_1.fetchUserAsync)({ sessionSecret });
    return {
        sessionSecret,
        id: userData.id,
        username: userData.username,
    };
}
exports.fetchSessionSecretAndSsoUserAsync = fetchSessionSecretAndSsoUserAsync;
